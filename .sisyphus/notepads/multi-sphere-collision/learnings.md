- 2026-02-05: Keep `MultiSphereCollision.at_config` fully JAX-compatible by gathering per-sphere link transforms from FK outputs (`link_poses.wxyz_xyz[..., sphere_link_indices, :]`) before applying local centers.
- 2026-02-05: Sphere self-collision over precomputed primitive pairs is cheapest as pure array math: `jnp.linalg.norm(c_i - c_j, axis=-1) - (r_i + r_j)`; no `Sphere` object construction needed at runtime.
- 2026-02-05: Ruff flags jaxtyping dimension expressions (e.g., `*batch`, `P`, `K`) under F722/F821; a file-level `# ruff: noqa: F722, F821` keeps rich shape annotations without altering runtime code.
- 2026-02-05: `build_multi_sphere_collision` should use parser link order (`RobotURDFParser.parse`) and per-link child joint `<origin>` translations to build one centerline per child; links with no children can still get one origin sphere when collision vertices exist.
- 2026-02-05: Mesh-informed radii are stable when computed per centerline segment window (projection interval around each center) with fallback to half of global perpendicular extent and a hard minimum radius clamp.
- 2026-02-06: TeaArm integration works cleanly by keeping `self.robot_coll` intact, building `self.multi_sphere_coll` in `__init__`, and adding a custom `@pk.costs.Cost.create_factory` residual that pipes `compute_self_collision_distance` through `colldist_from_sdf` with `margin=0.02`, `weight=5.0`.
- 2026-02-06: Occupancy validation is robust when combining `trimesh.sample.sample_surface` and `trimesh.sample.volume_mesh` per link, then testing point-in-sphere against link-filtered `sphere_link_indices`; TeaArm arm links stayed above 90% minimum occupancy.
- 2026-02-06: Multi-sphere regression tests stay fast and stable with module-scoped `TeaArmRobot` fixtures, direct JAX jit/grad checks on `compute_self_collision_distance`, and one end-to-end `PyrokiSolver.solve` call to validate cost integration.
- 2026-02-06: SRDF ignore parsing via `xml.etree.ElementTree` is straightforward (`<disable_collisions link1=... link2=.../>`), and should fail open by returning `()` on missing or invalid SRDF paths.
- 2026-02-06: Zero-pose auto-ignore can be generated at init-time by building a temporary collision model, marking primitive pairs with distance `< 0.005`, lifting those primitive hits to normalized link-name pairs, and rebuilding with the union of SRDF + auto pairs.
- 2026-02-06: After auto-ignore is enabled, `test_default_pose_no_penetration` can enforce the tighter safety gate (`min distance > -0.005`) and remains stable with TeaArm zero pose.
- 2026-02-06: Over-approximation coverage is reliable when each centerline sphere uses `sqrt(sidelength^2 + max_perp^2) + margin` and each link gets a post-pass uncovered-vertex check that adds one origin-centered fallback sphere when needed.
